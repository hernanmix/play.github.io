<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Player</title>
  <style>
    html, body {
      margin:0;
      padding:0;
      height:100%;
      background:#000;
    }
    #player {
      width:100%;
      height:100%;
    }
    /* Forzar fullscreen horizontal sin márgenes negros */
    :fullscreen #player,
    :-webkit-full-screen #player,
    :-moz-full-screen #player {
      width:100%;
      height:100%;
      object-fit:cover;
    }
  </style>
</head>
<body>
  <div id="player"></div>

  <!-- JWPlayer -->
  <script src="https://ssl.p.jwpcdn.com/player/v/8.26.0/jwplayer.js"></script>
  <script>
    jwplayer.key = "XSuP4qMl+9tK17QNb+4+th2Pm9AWgMO/cYH8CI0HGGr7bdjo";

    async function initPlayer() {
      const id = new URLSearchParams(window.location.search).get("id");
      if (!id) {
        document.getElementById("player").innerHTML = "<p style='color:red'>No se encontró ID</p>";
        return;
      }

      // Buscar en agenda.json
      const response = await fetch("https://hernanmix.github.io/play.github.io/agenda.json?v=" + Date.now());
      const eventos = await response.json();
      const evento = eventos.find(e => e.id === id);

      if (evento && evento.url) {
        jwplayer("player").setup({
          file: evento.url,
          type: evento.url.endsWith(".m3u8") ? "hls" : "dash",
          autostart: true,
          width: "100%",
          height: "100%",
          stretching: "uniform",
          skin: { name: "cyan" }
        });
      } else {
        document.getElementById("player").innerHTML = "<p style='color:red'>Stream no encontrado</p>";
      }
    }

    initPlayer();
  </script>
</body>
</html>
